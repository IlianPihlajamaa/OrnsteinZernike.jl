<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Electrolyte Mixtures with HNC · OrnsteinZernike.jl Documentation</title><meta name="title" content="Electrolyte Mixtures with HNC · OrnsteinZernike.jl Documentation"/><meta property="og:title" content="Electrolyte Mixtures with HNC · OrnsteinZernike.jl Documentation"/><meta property="twitter:title" content="Electrolyte Mixtures with HNC · OrnsteinZernike.jl Documentation"/><meta name="description" content="Documentation for OrnsteinZernike.jl Documentation."/><meta property="og:description" content="Documentation for OrnsteinZernike.jl Documentation."/><meta property="twitter:description" content="Documentation for OrnsteinZernike.jl Documentation."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">OrnsteinZernike.jl Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Index</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="SingleCompLJ.html">First steps</a></li><li><a class="tocitem" href="HardSphereMixture.html">Hard-sphere mixture</a></li><li><a class="tocitem" href="HighDensities.html">Solving at high densities</a></li><li><a class="tocitem" href="OtherDimensions.html">Other dimensions</a></li><li><a class="tocitem" href="Accuracy.html">Accuracy</a></li><li><a class="tocitem" href="ThermodynamicConsistency.html">Thermodynamic Consistency</a></li><li class="is-active"><a class="tocitem" href="Electrolyte_tutorial.html">Electrolyte Mixtures with HNC</a><ul class="internal"><li><a class="tocitem" href="#Step-1.-Setting-up-the-environment"><span>Step 1. Setting up the environment</span></a></li><li><a class="tocitem" href="#Step-2.-Define-physical-constants"><span>Step 2. Define physical constants</span></a></li><li><a class="tocitem" href="#Step-3.-Prepare-plotting"><span>Step 3. Prepare plotting</span></a></li><li><a class="tocitem" href="#Step-4.-Ion-charges-and-thermodynamics"><span>Step 4. Ion charges and thermodynamics</span></a></li><li><a class="tocitem" href="#Step-5.-Loop-over-concentrations"><span>Step 5. Loop over concentrations</span></a></li><li><a class="tocitem" href="#Step-6.-Display-results"><span>Step 6. Display results</span></a></li><li><a class="tocitem" href="#Results"><span>Results</span></a></li></ul></li></ul></li><li><span class="tocitem">Basics</span><ul><li><a class="tocitem" href="GeneralWorkflow.html">General Workflow</a></li><li><a class="tocitem" href="Potentials.html">Interaction Potentials</a></li><li><a class="tocitem" href="Systems.html">Systems</a></li><li><a class="tocitem" href="Closures.html">Closures</a></li><li><a class="tocitem" href="Solvers.html">Solvers</a></li><li><a class="tocitem" href="Grid.html">Choosing Grid Parameters (M and dr)</a></li><li><a class="tocitem" href="Mixtures.html">Mixtures in OrnsteinZernike.jl</a></li><li><a class="tocitem" href="ChargedSystems.html">Charged Systems</a></li></ul></li><li><a class="tocitem" href="Theory.html">Theory</a></li><li><span class="tocitem">Extending</span><ul><li><a class="tocitem" href="ExtendingPotentials.html">Defining your own potentials</a></li><li><a class="tocitem" href="ExtendingClosures.html">Defining your own closure</a></li></ul></li><li><a class="tocitem" href="API.html">API</a></li><li><a class="tocitem" href="FromPython.html">From Python</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href="Electrolyte_tutorial.html">Electrolyte Mixtures with HNC</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="Electrolyte_tutorial.html">Electrolyte Mixtures with HNC</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/IlianPihlajamaa/OrnsteinZernike.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/IlianPihlajamaa/OrnsteinZernike.jl/blob/main/docs/src/Electrolyte_tutorial.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Electrolyte-Mixtures-with-HNC"><a class="docs-heading-anchor" href="#Electrolyte-Mixtures-with-HNC">Electrolyte Mixtures with HNC</a><a id="Electrolyte-Mixtures-with-HNC-1"></a><a class="docs-heading-anchor-permalink" href="#Electrolyte-Mixtures-with-HNC" title="Permalink"></a></h1><p>In this tutorial, we demonstrate how to use <code>OrnsteinZernike.jl</code> to reproduce classical results for symmetric electrolytes obtained with the <strong>Hypernetted Chain (HNC)</strong> closure. Specifically, this page will reproduce some of the results presented in.</p><blockquote><p>D.‐M. Duh; A. D. J. Haymet, <em>Integral equation theory for charged liquids: Model 2–2 electrolytes and the bridge function</em>, J. Chem. Phys. <strong>97</strong>, 7716–7729 (1992).</p></blockquote><p>This paper studies <strong>2:2 electrolytes</strong> (e.g., divalent cations and anions) using integral equation theory. Our goal here is to set up the same model, run the HNC closure, and reproduce the radial distribution functions (RDFs) and excess energies across different concentrations,.  </p><hr/><h2 id="Step-1.-Setting-up-the-environment"><a class="docs-heading-anchor" href="#Step-1.-Setting-up-the-environment">Step 1. Setting up the environment</a><a id="Step-1.-Setting-up-the-environment-1"></a><a class="docs-heading-anchor-permalink" href="#Step-1.-Setting-up-the-environment" title="Permalink"></a></h2><pre><code class="language-julia hljs">using OrnsteinZernike, StaticArrays
using Plots</code></pre><hr/><h2 id="Step-2.-Define-physical-constants"><a class="docs-heading-anchor" href="#Step-2.-Define-physical-constants">Step 2. Define physical constants</a><a id="Step-2.-Define-physical-constants-1"></a><a class="docs-heading-anchor-permalink" href="#Step-2.-Define-physical-constants" title="Permalink"></a></h2><p>We work with a set of standard physical constants: particle size <code>σ</code>, dielectric constant <code>ϵr</code>, elementary charge <code>e</code>, vacuum permittivity <code>ϵ0</code>, and Boltzmann constant <code>kB</code>. The parameter <code>B</code> sets the strength of the short-ranged repulsive potential. The values are taken from the paper above.</p><pre><code class="language-julia hljs">σ = 2.8428 * 10^-10      # particle size (m)
ϵr = 78.358              # relative permittivity of water at 25 °C
e = 1.602176634e-19      # elementary charge (C)
ϵ0 = 8.8541878128e-12    # vacuum permittivity (F/m)
ϵ = ϵ0 * ϵr
kB = 1.380649e-23        # Boltzmann constant (J/K)
B = 5377.75 * 4 * 10^-10 # repulsion parameter (m K)</code></pre><p>The potential used is given by</p><p class="math-container">\[u_{ij}(r) = \frac{k_B B}{\sigma} * \left(\frac{\sigma}{r}\right)^9 +  \frac{Z_i Z_j e^2}{4\pi\epsilon r}\]</p><p>For convenience, we can also compute the approximate position of the potential minimum (not strictly needed, but useful for diagnostics):</p><pre><code class="language-julia hljs">Rm = (3^(1/4) * B^(1/8) * kB^(1/8)*(4*π*ϵ)^(1/8)*σ)/(e^(1/4)*2^(1/4))</code></pre><hr/><h2 id="Step-3.-Prepare-plotting"><a class="docs-heading-anchor" href="#Step-3.-Prepare-plotting">Step 3. Prepare plotting</a><a id="Step-3.-Prepare-plotting-1"></a><a class="docs-heading-anchor-permalink" href="#Step-3.-Prepare-plotting" title="Permalink"></a></h2><p>We will plot two RDFs: the like–like distribution function <code>g₁₁(r)</code> and the unlike distribution function <code>g₁₂(r)</code>.</p><pre><code class="language-julia hljs">p1 = plot(xlabel=&quot;r (Å)&quot;, ylab=&quot;g₁₁(r)&quot;)
p2 = plot(xlabel=&quot;r (Å)&quot;, ylab=&quot;g₁₂(r)&quot;)</code></pre><hr/><h2 id="Step-4.-Ion-charges-and-thermodynamics"><a class="docs-heading-anchor" href="#Step-4.-Ion-charges-and-thermodynamics">Step 4. Ion charges and thermodynamics</a><a id="Step-4.-Ion-charges-and-thermodynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Step-4.-Ion-charges-and-thermodynamics" title="Permalink"></a></h2><p>We consider a symmetric 2:2 electrolyte, so the charges are <code>+2</code> and <code>–2</code>. The temperature is set to room temperature (298 K). </p><pre><code class="language-julia hljs">Z = [2, -2]
T0 = 273.15
kBT = kB * (T0 + 25)   # thermal energy at 298 K


# Bjerrum length in meters
bjerrum_length = e^2/(4*π*ϵ*kBT)</code></pre><hr/><h2 id="Step-5.-Loop-over-concentrations"><a class="docs-heading-anchor" href="#Step-5.-Loop-over-concentrations">Step 5. Loop over concentrations</a><a id="Step-5.-Loop-over-concentrations-1"></a><a class="docs-heading-anchor-permalink" href="#Step-5.-Loop-over-concentrations" title="Permalink"></a></h2><p>We now study several salt concentrations (in mol/L). For each concentration:</p><ol><li>Convert to number density (per m³).</li><li>Build the mixture model.</li><li>Solve the Ornstein–Zernike equation with the HNC closure.</li><li>Extract the RDFs and excess energy.</li><li>Add the results to the plots.</li></ol><pre><code class="language-julia hljs">for (i,c) in enumerate([0.001, 0.02, 0.0625, 0.2, 0.5625]) # mol/L
    # Convert molar concentration to number density
    ρ0 = c * 6.02214076e23 * 1e3
    ρ = [ρ0, ρ0] # equal density of cations and anions

    # Compute Debye screening parameter
    κD = sqrt(1/(ϵr * ϵ0 * kBT)* e^2 * sum(ρ .* Z.^2))
    @show c, Rm * κD

    # Numerical grid settings
    # From here we work in units of kBT and σ
    M = 4096
    dims = 3
    dr = 0.105 * 10^-10 / σ
    Sones = ones(SMatrix{2,2, Float64, 4})

    # Define short-range repulsive potential
    pot = PowerLaw(kB*B/σ*Sones/kBT, Sones, 9)

    # Build system and add Coulomb interactions
    system = SimpleMixture(dims, ρ*σ^3, 1, pot)
    system = SimpleChargedMixture(system, Z, bjerrum_length / σ)

    # Choose closure and numerical method
    closure = HypernettedChain()
    method = FourierIteration(M = M,
                              dr = dr,
                              tolerance = 1e-8,
                              mixing_parameter = 0.05,
                              verbose = false,
                              max_iterations = 10^6)

    # Solve OZ equation with HNC closure
    sol = solve(system, closure, method,
                coulombsplitting = OrnsteinZernike.NoCoulombSplitting())

    # Extract RDFs
    r = sol.r
    g = sol.gr

    # Compute excess energy (per particle, in reduced units)
    Ex = OrnsteinZernike.compute_excess_energy(sol, system)
    @show -Ex

    # Plot g₁₁(r) and g₁₂(r)
    plot!(p1, r*1e10*σ, g[:, 2, 2], label=&quot;c=$(c)M&quot;)
    plot!(p2, r*1e10*σ, g[:, 1, 2], label=&quot;c=$(c)M&quot;)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(c, Rm * κD) = (0.001, 0.08739679459429212)
-Ex = 0.4328381727449978
(c, Rm * κD) = (0.02, 0.39085034745684666)
-Ex = 1.2793652010176915
(c, Rm * κD) = (0.0625, 0.6909323277896364)
-Ex = 1.7127739116269136
(c, Rm * κD) = (0.2, 1.2359773222318353)
-Ex = 2.1977531982678937
(c, Rm * κD) = (0.5625, 2.0727969833689093)
-Ex = 2.6462503836422564</code></pre><hr/><h2 id="Step-6.-Display-results"><a class="docs-heading-anchor" href="#Step-6.-Display-results">Step 6. Display results</a><a id="Step-6.-Display-results-1"></a><a class="docs-heading-anchor-permalink" href="#Step-6.-Display-results" title="Permalink"></a></h2><p>Finally, we set axis limits and show the combined plots.</p><pre><code class="language-julia hljs">plot!(p2, xlims=(0.0, 16.0))
plot!(p1, xlims=(0.0, 16.0))

p = plot(p1, p2, layout=(2,1))</code></pre><img src="Electrolyte_tutorial-98593a87.svg" alt="Example block output"/><hr/><h2 id="Results"><a class="docs-heading-anchor" href="#Results">Results</a><a id="Results-1"></a><a class="docs-heading-anchor-permalink" href="#Results" title="Permalink"></a></h2><p>Running this script produces the ion–ion radial distribution functions at different concentrations. These curves reproduce the exact behavior reported in Duh &amp; Haymet (1992). The excess energies match exactly the data from table III (except for one data point for some reason).  </p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="ThermodynamicConsistency.html">« Thermodynamic Consistency</a><a class="docs-footer-nextpage" href="GeneralWorkflow.html">General Workflow »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 2 September 2025 15:57">Tuesday 2 September 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
